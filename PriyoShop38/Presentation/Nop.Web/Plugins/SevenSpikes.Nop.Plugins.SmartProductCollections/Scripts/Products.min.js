(function(n){function r(t){var i=n("img",t),r=i.length;i.load(function(){r--;r<=0&&n.event.trigger({type:"imagesLoaded"})})}var t=n(window),u=function(){n(".spc-products[notLoaded], .spc-categories[notLoaded]").length===0&&t.off("scroll.smart-products")},i=function(){var i=t.scrollTop()+t.outerHeight();n(".spc-products[notLoaded]").each(function(){var t=n(this);t.offset().top<i&&(t.removeAttr("notLoaded"),t.find(".tab:first").click())});n(".spc-categories[notLoaded]").each(function(){var t=n(this);t.offset().top<i&&(t.removeAttr("notLoaded"),n.ajax({url:t.attr("data-getCategoryGroupInfoUrl"),type:"POST",data:{categoryId:parseInt(t.attr("data-categoryGroupId"))||0}}).done(function(i){t.html(i);t.find(".navigation .tab:first-of-type").removeAttr("notLoaded").addClass("active");t.find(".category-products .product-grid:first-of-type").addClass("active");n.event.trigger({type:"newProductsAddedToPageEvent"})}).fail(function(){t.remove()}))});u()},f=function(){n(".spc-products .tab").off("click.smartproductcollections").on("click.smartproductcollections",function(t){var i,f,u;(t.preventDefault(),i=n(this),f=parseInt(i.attr("data-tabId")),isNaN(f))||(u=i.closest(".spc-products"),i.hasClass("loaded")?(i.addClass("active").siblings(".tab").removeClass("active"),u.find('.spc-body .product-grid[data-tabId="'+f+'"]').addClass("active").siblings(".product-grid").removeClass("active")):(i.addClass("loaded"),u.find(".loading-overlay").show(),n.ajax({url:u.attr("data-getItemProductsUrl"),type:"POST",data:{id:f}}).done(function(t){var e=u.find('.spc-body .product-grid[data-tabId="'+f+'"]');e.find(".item-grid").html(t);i.addClass("active").siblings(".tab").removeClass("active");e.addClass("active").siblings(".product-grid").removeClass("active");r(e);n.event.trigger({type:"newProductsAddedToPageEvent"})}).always(function(){n(window).on("imagesLoaded",function(){u.find(".loading-overlay").fadeOut()})})))});n(".spc-categories").on("click",".navigation .tab",function(){var t=n(this),f=parseInt(t.attr("data-tabId"))||0,i=t.closest(".spc-categories"),e=parseInt(i.attr("data-categoryGroupId"))||0,u=i.find('.category-products .product-grid[data-tabId="'+f+'"]');t.is("[notLoaded]")?(t.removeAttr("notLoaded"),i.find(".loading-overlay").show(),n.ajax({url:i.attr("data-getItemProductsUrl"),type:"POST",data:{id:f,categoryId:e}}).done(function(i){u.children(".item-grid").html(i);t.addClass("active").siblings(".tab").removeClass("active");u.addClass("active").siblings(".product-grid").removeClass("active");r(u);n.event.trigger({type:"newProductsAddedToPageEvent"})}).always(function(){n(window).on("imagesLoaded",function(){i.find(".loading-overlay").fadeOut()})})):(t.addClass("active").siblings(".tab").removeClass("active"),u.addClass("active").siblings(".product-grid").removeClass("active"));i.find('.category-mobile-navigation-select option[value="'+f+'"]').attr("selected","selected")});n(".spc-categories").on("change",".category-mobile-navigation-select",function(){var t=n(this);t.closest(".spc-categories").find('.navigation .tab[data-tabId="'+t.val()+'"]').click()})};n(document).ready(function(){f();setTimeout(i,200);t.on("scroll.smart-products",i)})})(jQuery);